<!Doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js" ></script>

    <title><%= title %></title>

    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:400,100,300,500">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="common/css/style.css">

    <link rel="stylesheet" href="common/css/progressbar.css">

    <% include ./navbar.ejs %>

    <script>
    function removeUser(id){
      var result = confirm("사용자를 정말 삭제하시겠습니까?");
      // 사용자를 삭제해도 그 사용자의 프로젝트는 삭제되지 않음. 다시 바인딩해주면 사용 가능
      if(result)
      {
        //console.log("delete request : "+ id);
        $.ajax({
  			  url:"/deleteUser/"+id,
  			  type:"delete",
  			  dataType:"json",
  			  success: function(result){
            location.href="../admin";
  			  },
  			  error:function(request,status,error){
  		       console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
  			  }
  		  });
      }
    }
/*
     function updateUser(id) {
       var result = confirm(tname+"을(를) 추가하시겠습니까?");
       if(result){
         $.ajax({
  			  url:"/"+pid+"/"+tname,
  			  type:"post",
  			  dataType:"json",
  			  success: function(result){
            location.href="../update/"+pid;
  			  },
  			  error:function(request,status,error){
  		       console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
  			  }
  		  });
       }
     }*/

    </script>

  </head>
  <body>

  <div class="container-fluid">
    <div class="row">

    <h3> 새 사용자 등록 </h3>
    <form action="/newuser" method="post">
      사용자 이름 <input type="text" name="name">
      비밀번호 <input type="password" name="pw">
      <button type="submit"> 등록 </button>
    </form>

     <form action="" method="post" float="middle">
        <table>
        <thead>
        <tr>
          <th>#</th>
          <th>이름</th>
          <!--th>비밀번호 재설정</th-->
          <th>사용자 삭제</th>

        </tr>
        </thead>
        <tbody>
          <% for(var i=0; i<users.length; i++) { %>
          <tr>
            <td> <%= i+1 %> </td>
            <td> <%= users[i].name %> </td>
            <!--td> <input type="hidden" name="uid" value="<%= users[i]._id %> " > <input type="password" name="pw"> <button type="submit"> <span class="glyphicon glyphicon-wrench" aria-hidden="true" > </span> </button> </td-->
            <td> <button id="<%= users[i]._id %>" onclick="removeUser(this.id)"> <span class="glyphicon glyphicon-trash" aria-hidden="true" > </span> </button> </td>

          </tr>
         <% } %>
        </tbody>
      </table>
      </form>

    </div>
    </div> <!--container-->
  </body>
</html>
